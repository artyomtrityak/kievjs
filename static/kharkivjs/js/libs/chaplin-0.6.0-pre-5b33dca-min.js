// Generated by CoffeeScript 1.3.3
/*
Chaplin 0.6.0-pre.

Chaplin may be freely distributed under the MIT license.
For all details and documentation:
http://github.com/chaplinjs/chaplin
*/(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){return function(){return e.apply(t,arguments)}},i=[].slice;define("chaplin/application",["backbone","chaplin/mediator","chaplin/dispatcher","chaplin/views/layout","chaplin/lib/router","chaplin/lib/event_broker"],function(e,t,n,r,i,s){"use strict";var o;return o=function(){function t(){}return t.extend=e.Model.extend,_(t.prototype).extend(s),t.prototype.title="",t.prototype.dispatcher=null,t.prototype.layout=null,t.prototype.router=null,t.prototype.initialize=function(){},t.prototype.initDispatcher=function(e){return this.dispatcher=new n(e)},t.prototype.initLayout=function(e){var t;return e==null&&(e={}),(t=e.title)==null&&(e.title=this.title),this.layout=new r(e)},t.prototype.initRouter=function(e,t){return this.router=new i(t),typeof e=="function"&&e(this.router.match),this.router.startHistory()},t.prototype.disposed=!1,t.prototype.dispose=function(){var e,t,n,r;if(this.disposed)return;t=["dispatcher","layout","router"];for(n=0,r=t.length;n<r;n++){e=t[n];if(this[e]==null)continue;this[e].dispose(),delete this[e]}return this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},t}()}),define("chaplin/mediator",["underscore","backbone","chaplin/lib/support","chaplin/lib/utils"],function(e,t,n,r){"use strict";var i;return i={},i.subscribe=t.Events.on,i.unsubscribe=t.Events.off,i.publish=t.Events.trigger,i.on=i.subscribe,i._callbacks=null,r.readonly(i,"subscribe","unsubscribe","publish","on"),i.seal=function(){if(n.propertyDescriptors&&Object.seal)return Object.seal(i)},r.readonly(i,"seal"),i}),define("chaplin/dispatcher",["underscore","backbone","chaplin/lib/utils","chaplin/lib/event_broker"],function(e,t,n,r){"use strict";var i;return i=function(){function i(){this.initialize.apply(this,arguments)}return i.extend=t.Model.extend,e(i.prototype).extend(r),i.prototype.previousControllerName=null,i.prototype.currentControllerName=null,i.prototype.currentController=null,i.prototype.currentAction=null,i.prototype.currentParams=null,i.prototype.url=null,i.prototype.initialize=function(t){return t==null&&(t={}),this.settings=e(t).defaults({controllerPath:"controllers/",controllerSuffix:"_controller"}),this.subscribeEvent("matchRoute",this.matchRoute),this.subscribeEvent("!startupController",this.startupController)},i.prototype.matchRoute=function(e,t,n){return this.startupController(e.controller,e.action,t,n)},i.prototype.startupController=function(t,n,r,i){var s,o;n==null&&(n="index"),r==null&&(r={}),i==null&&(i={}),i.changeURL!==!1&&(i.changeURL=!0),i.forceStartup!==!0&&(i.forceStartup=!1),o=!i.forceStartup&&this.currentControllerName===t&&this.currentAction===n&&(!this.currentParams||e(r).isEqual(this.currentParams));if(o)return;return s=e(this.controllerLoaded).bind(this,t,n,r,i),this.loadController(t,s)},i.prototype.loadController=function(e,t){var r,i;return r=n.underscorize(e)+this.settings.controllerSuffix,i=this.settings.controllerPath+r,(typeof define!="undefined"&&define!==null?define.amd:void 0)?require([i],t):t(require(i))},i.prototype.controllerLoaded=function(e,t,n,r,i){var s,o,u;u=this.currentControllerName||null,o=this.currentController||null,o&&(this.publishEvent("beforeControllerDispose",o),o.dispose(n,e)),s=new i(n,u),s[t](n,u);if(s.redirected)return;return this.previousControllerName=u,this.currentControllerName=e,this.currentController=s,this.currentAction=t,this.currentParams=n,this.adjustURL(s,n,r),this.publishEvent("startupController",{previousControllerName:this.previousControllerName,controller:this.currentController,controllerName:this.currentControllerName,params:this.currentParams})},i.prototype.adjustURL=function(e,t,n){var r;if(typeof n.path=="string")r=n.path;else if(typeof e.historyURL=="function")r=e.historyURL(t);else{if(typeof e.historyURL!="string")throw new Error("Dispatcher#adjustURL: controller for "+(""+this.currentControllerName+" does not provide a historyURL"));r=e.historyURL}return n.changeURL&&this.publishEvent("!router:changeURL",r,n),this.url=r},i.prototype.disposed=!1,i.prototype.dispose=function(){if(this.disposed)return;return this.unsubscribeAllEvents(),this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},i}()}),define("chaplin/controllers/controller",["underscore","backbone","chaplin/lib/event_broker"],function(t,n,r){"use strict";var i;return i=function(){function i(){this.initialize.apply(this,arguments)}return i.extend=n.Model.extend,t(i.prototype).extend(r),i.prototype.view=null,i.prototype.currentId=null,i.prototype.redirected=!1,i.prototype.initialize=function(){},i.prototype.redirectTo=function(e,t,n,r){return this.redirected=!0,arguments.length===1?this.publishEvent("!router:route",e,{},function(e){if(!e)throw new Error("Controller#redirectTo: no route matched")}):this.publishEvent("!startupController",e,t,n,r)},i.prototype.disposed=!1,i.prototype.dispose=function(){var t,n,r,i,s;if(this.disposed)return;for(n in this){if(!e.call(this,n))continue;t=this[n],t&&typeof t.dispose=="function"&&(t.dispose(),delete this[n])}this.unsubscribeAllEvents(),r=["currentId","redirected"];for(i=0,s=r.length;i<s;i++)n=r[i],delete this[n];return this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},i}()}),define("chaplin/models/collection",["underscore","backbone","chaplin/lib/event_broker","chaplin/models/model"],function(e,n,r,i){"use strict";var s;return s=function(n){function s(){return s.__super__.constructor.apply(this,arguments)}return t(s,n),e(s.prototype).extend(r),s.prototype.model=i,s.prototype.initDeferred=function(){return e(this).extend($.Deferred())},s.prototype.serialize=function(){var e,t,n,r,s;r=this.models,s=[];for(t=0,n=r.length;t<n;t++)e=r[t],e instanceof i?s.push(e.serialize()):s.push(e.toJSON());return s},s.prototype.addAtomic=function(e,t){var n,r;t==null&&(t={});if(!e.length)return;t.silent=!0,n=typeof t.at=="number"?"pop":"shift";while(r=e[n]())this.add(r,t);return this.trigger("reset")},s.prototype.update=function(t,n){var r,i,s,o,u,a,f,l,c;n==null&&(n={}),r=this.pluck("id").join(),s=e(t).pluck("id"),u=s.join();if(u!==r){l=e(s),i=this.models.length;while(i--)o=this.models[i],l.include(o.id)||this.remove(o)}if(u!==r||n.deep)for(i=f=0,c=t.length;f<c;i=++f)o=t[i],a=this.get(o.id),a?n.deep&&a.set(o):this.add(o,{at:i})},s.prototype.disposed=!1,s.prototype.dispose=function(){var e,t,n,r;if(this.disposed)return;this.trigger("dispose",this),this.reset([],{silent:!0}),this.unsubscribeAllEvents(),this.off(),typeof this.reject=="function"&&this.reject(),t=["model","models","_byId","_byCid","_callbacks"];for(n=0,r=t.length;n<r;n++)e=t[n],delete this[e];return this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},s}(n.Collection)}),define("chaplin/models/model",["underscore","backbone","chaplin/lib/utils","chaplin/lib/event_broker"],function(e,r,i,s){"use strict";var o;return o=function(o){function a(){return a.__super__.constructor.apply(this,arguments)}var u;return t(a,o),e(a.prototype).extend(s),a.prototype.initDeferred=function(){return e(this).extend($.Deferred())},a.prototype.getAttributes=function(){return this.attributes},u=function(e,t,s){var o,a,f,l;s?s.push(e):(o=i.beget(t),s=[e]);for(f in t)l=t[f],l instanceof r.Model?(o==null&&(o=i.beget(t)),o[f]=l===e||n.call(s,l)>=0?null:u(l,l.getAttributes(),s)):l instanceof r.Collection&&(o==null&&(o=i.beget(t)),o[f]=function(){var e,t,n,r;n=l.models,r=[];for(e=0,t=n.length;e<t;e++)a=n[e],r.push(u(a,a.getAttributes(),s));return r}());return s.pop(),o||t},a.prototype.serialize=function(){return u(this,this.getAttributes())},a.prototype.disposed=!1,a.prototype.dispose=function(){var e,t,n,r;if(this.disposed)return;this.trigger("dispose",this),this.unsubscribeAllEvents(),this.off(),typeof this.reject=="function"&&this.reject(),t=["collection","attributes","changed","_escapedAttributes","_previousAttributes","_silent","_pending","_callbacks"];for(n=0,r=t.length;n<r;n++)e=t[n],delete this[e];return this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},a}(r.Model)}),define("chaplin/views/layout",["jquery","underscore","backbone","chaplin/lib/utils","chaplin/lib/event_broker"],function(e,t,n,i,s){"use strict";var o;return o=function(){function o(){this.openLink=r(this.openLink,this),this.initialize.apply(this,arguments)}return o.extend=n.Model.extend,t(o.prototype).extend(s),o.prototype.title="",o.prototype.events={},o.prototype.el=document,o.prototype.$el=e(document),o.prototype.cid="chaplin-layout",o.prototype.initialize=function(e){return e==null&&(e={}),this.title=e.title,this.settings=t(e).defaults({titleTemplate:t.template("<%= subtitle %> â€“ <%= title %>"),openExternalToBlank:!1,routeLinks:"a, .go-to",skipRouting:".noscript",scrollTo:[0,0]}),this.subscribeEvent("beforeControllerDispose",this.hideOldView),this.subscribeEvent("startupController",this.showNewView),this.subscribeEvent("startupController",this.adjustTitle),this.settings.routeLinks&&this.startLinkRouting(),this.delegateEvents()},o.prototype.delegateEvents=n.View.prototype.delegateEvents,o.prototype.undelegateEvents=n.View.prototype.undelegateEvents,o.prototype.hideOldView=function(e){var t,n;t=this.settings.scrollTo,t&&window.scrollTo(t[0],t[1]),n=e.view;if(n)return n.$el.css("display","none")},o.prototype.showNewView=function(e){var t;t=e.controller.view;if(t)return t.$el.css({display:"block",opacity:1,visibility:"visible"})},o.prototype.adjustTitle=function(e){var t,n;return n=this.title||"",t=e.controller.title||"",n=this.settings.titleTemplate({title:n,subtitle:t}),setTimeout(function(){return document.title=n},50)},o.prototype.startLinkRouting=function(){if(this.settings.routeLinks)return e(document).on("click",this.settings.routeLinks,this.openLink)},o.prototype.stopLinkRouting=function(){if(this.settings.routeLinks)return e(document).off("click",this.settings.routeLinks)},o.prototype.openLink=function(t){var n,r,s,o,u,a,f,l,c,h;if(i.modifierKeyPressed(t))return;r=t.currentTarget,n=e(r),u=r.nodeName==="A",s=n.attr("href")||n.data("href")||null;if(s===null||s===void 0||s===""||s.charAt(0)==="#")return;if(u&&(n.attr("target")==="_blank"||n.attr("rel")==="external"||(c=r.protocol)!=="http:"&&c!=="https:"&&c!=="file:"))return;f=this.settings.skipRouting,l=typeof f;if(l==="function"&&!f(s,r)||l==="string"&&n.is(f))return;o=!u||(h=r.hostname)===location.hostname||h==="";if(!o){this.settings.openExternalToBlank&&(t.preventDefault(),window.open(r.href));return}u?(a=r.pathname+r.search,a.charAt(0)!=="/"&&(a="/"+a)):a=s,this.publishEvent("!router:route",a,{},function(e){e?t.preventDefault():u||(location.href=a)})},o.prototype.disposed=!1,o.prototype.dispose=function(){if(this.disposed)return;return this.stopLinkRouting(),this.unsubscribeAllEvents(),this.undelegateEvents(),delete this.title,this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},o}()}),define("chaplin/views/view",["jquery","underscore","backbone","chaplin/lib/utils","chaplin/lib/event_broker","chaplin/models/model","chaplin/models/collection"],function(e,n,r,i,s,o,u){"use strict";var a;return a=function(r){function a(e){this.initialize!==a.prototype.initialize&&i.wrapMethod(this,"initialize"),this.render!==a.prototype.render?i.wrapMethod(this,"render"):this.render=n(this.render).bind(this),e&&n(this).extend(n.pick(e,["autoRender","container","containerMethod"])),a.__super__.constructor.apply(this,arguments)}return t(a,r),n(a.prototype).extend(s),a.prototype.autoRender=!1,a.prototype.container=null,a.prototype.containerMethod="append",a.prototype.subviews=null,a.prototype.subviewsByName=null,a.prototype.initialize=function(e){this.subviews=[],this.subviewsByName={},(this.model||this.collection)&&this.modelBind("dispose",this.dispose);if(!this.initializeIsWrapped)return this.afterInitialize()},a.prototype.afterInitialize=function(){if(this.autoRender)return this.render()},a.prototype.delegate=function(e,t,r){var i,s,o,u,a;if(typeof e!="string")throw new TypeError("View#delegate: first argument must be a string");if(arguments.length===2)o=t;else{if(arguments.length!==3)throw new TypeError("View#delegate: only two or three arguments are allowed");a=t;if(typeof a!="string")throw new TypeError("View#delegate: second argument must be a string");o=r}if(typeof o!="function")throw new TypeError("View#delegate: handler argument must be function");return u=function(){var t,n,r,s;r=e.split(" "),s=[];for(t=0,n=r.length;t<n;t++)i=r[t],s.push(""+i+".delegate"+this.cid);return s}.call(this),s=u.join(" "),o=n(o).bind(this),a?this.$el.on(s,a,o):this.$el.on(s,o),o},a.prototype.undelegate=function(){return this.$el.unbind(".delegate"+this.cid)},a.prototype.modelBind=function(e,t){var n;if(typeof e!="string")throw new TypeError("View#modelBind: type must be a string");if(typeof t!="function")throw new TypeError("View#modelBind: handler argument must be function");n=this.model||this.collection;if(!n)throw new TypeError("View#modelBind: no model or collection set");return n.off(e,t,this),n.on(e,t,this)},a.prototype.modelUnbind=function(e,t){var n;if(typeof e!="string")throw new TypeError("View#modelUnbind: type argument must be a string");if(typeof t!="function")throw new TypeError("View#modelUnbind: handler argument must be a function");n=this.model||this.collection;if(!n)return;return n.off(e,t)},a.prototype.modelUnbindAll=function(){var e;e=this.model||this.collection;if(!e)return;return e.off(null,null,this)},a.prototype.pass=function(e,t){var n=this;return this.modelBind("change:"+e,function(e,r){var i;return i=n.$(t),i.is("input, textarea, select, button")?i.val(r):i.text(r)})},a.prototype.subview=function(e,t){if(e&&t)return this.removeSubview(e),this.subviews.push(t),this.subviewsByName[e]=t,t;if(e)return this.subviewsByName[e]},a.prototype.removeSubview=function(e){var t,r,i,s,o,u;if(!e)return;if(typeof e=="string")r=e,o=this.subviewsByName[r];else{o=e,u=this.subviewsByName;for(i in u){s=u[i];if(o===s){r=i;break}}}if(!(r&&o&&o.dispose))return;return o.dispose(),t=n(this.subviews).indexOf(o),t>-1&&this.subviews.splice(t,1),delete this.subviewsByName[r]},a.prototype.getTemplateData=function(){var e,t,n,r,s,a,f;if(this.model)r=this.model instanceof o?this.model.serialize():i.beget(this.model.attributes);else if(this.collection){if(this.collection instanceof u)e=this.collection.serialize();else{e=[],f=this.collection.models;for(s=0,a=f.length;s<a;s++)t=f[s],e.push(i.beget(t.attributes))}r={items:e}}else r={};return n=this.model||this.collection,n&&(typeof n.state=="function"&&!("resolved"in r)&&(r.resolved=n.state()==="resolved"),typeof n.isSynced=="function"&&!("synced"in r)&&(r.synced=n.isSynced())),r},a.prototype.getTemplateFunction=function(){throw new Error("View#getTemplateFunction must be overridden")},a.prototype.render=function(){var e,t;return this.disposed?!1:(t=this.getTemplateFunction(),typeof t=="function"&&(e=t(this.getTemplateData()),this.$el.empty().append(e)),this.renderIsWrapped||this.afterRender(),this)},a.prototype.afterRender=function(){if(this.container)return e(this.container)[this.containerMethod](this.el),this.trigger("addedToDOM")},a.prototype.disposed=!1,a.prototype.dispose=function(){var e,t,n,r,i,s,o,u;if(this.disposed)return;if(this.subviews==null)throw new Error("Your `initialize` method must include a super call to        Chaplin `initialize`");u=this.subviews;for(r=0,s=u.length;r<s;r++)n=u[r],n.dispose();this.unsubscribeAllEvents(),this.modelUnbindAll(),this.off(),this.$el.remove(),t=["el","$el","options","model","collection","subviews","subviewsByName","_callbacks"];for(i=0,o=t.length;i<o;i++)e=t[i],delete this[e];return this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},a}(r.View)}),define("chaplin/views/collection_view",["jquery","underscore","chaplin/views/view"],function(n,i,s){"use strict";var o;return o=function(n){function s(e){this.renderAllItems=r(this.renderAllItems,this),this.showHideFallback=r(this.showHideFallback,this),this.itemsResetted=r(this.itemsResetted,this),this.itemRemoved=r(this.itemRemoved,this),this.itemAdded=r(this.itemAdded,this),e&&i(this).extend(i.pick(e,["renderItems","itemView"])),s.__super__.constructor.apply(this,arguments)}return t(s,n),s.prototype.itemView=null,s.prototype.autoRender=!0,s.prototype.renderItems=!0,s.prototype.animationDuration=500,s.prototype.useCssAnimation=!1,s.prototype.listSelector=null,s.prototype.$list=null,s.prototype.fallbackSelector=null,s.prototype.$fallback=null,s.prototype.loadingSelector=null,s.prototype.$loading=null,s.prototype.itemSelector=null,s.prototype.filterer=null,s.prototype.filterCallback=function(e,t){var n;return n=t?"":"none",e.$el.stop(!0,!0).css("display",n)},s.prototype.visibleItems=null,s.prototype.initialize=function(e){e==null&&(e={}),s.__super__.initialize.apply(this,arguments),this.visibleItems=[],this.addCollectionListeners();if(e.filterer!=null)return this.filter(e.filterer)},s.prototype.addCollectionListeners=function(){return this.modelBind("add",this.itemAdded),this.modelBind("remove",this.itemRemoved),this.modelBind("reset",this.itemsResetted)},s.prototype.getTemplateFunction=function(){},s.prototype.render=function(){s.__super__.render.apply(this,arguments),this.$list=this.listSelector?this.$(this.listSelector):this.$el,this.initFallback(),this.initLoadingIndicator();if(this.renderItems)return this.renderAllItems()},s.prototype.itemAdded=function(e,t,n){return n==null&&(n={}),this.renderAndInsertItem(e,n.index)},s.prototype.itemRemoved=function(e){return this.removeViewForItem(e)},s.prototype.itemsResetted=function(){return this.renderAllItems()},s.prototype.initFallback=function(){if(!this.fallbackSelector)return;return this.$fallback=this.$(this.fallbackSelector),this.on("visibilityChange",this.showHideFallback),this.modelBind("syncStateChange",this.showHideFallback),this.showHideFallback()},s.prototype.showHideFallback=function(){var e;return e=this.visibleItems.length===0&&(typeof this.collection.isSynced=="function"?this.collection.isSynced():!0),this.$fallback.css("display",e?"block":"none")},s.prototype.initLoadingIndicator=function(){if(!this.loadingSelector||typeof this.collection.isSyncing!="function")return;return this.$loading=this.$(this.loadingSelector),this.modelBind("syncStateChange",this.showHideLoadingIndicator),this.showHideLoadingIndicator()},s.prototype.showHideLoadingIndicator=function(){var e;return e=this.collection.length===0&&this.collection.isSyncing(),this.$loading.css("display",e?"block":"none")},s.prototype.getItemViews=function(){var e,t,n,r;e={},r=this.subviewsByName;for(t in r)n=r[t],t.slice(0,9)==="itemView:"&&(e[t.slice(9)]=n);return e},s.prototype.filter=function(e,t){var n,r,s,o,u,a,f;this.filterer=e,t&&(this.filterCallback=t),t==null&&(t=this.filterCallback);if(!i(this.getItemViews()).isEmpty()){f=this.collection.models;for(r=u=0,a=f.length;u<a;r=++u){s=f[r],n=typeof e=="function"?e(s,r):!0,o=this.subview("itemView:"+s.cid);if(!o)throw new Error("CollectionView#filter: "+("no view found for "+s.cid));this.filterCallback(o,n),this.updateVisibleItems(o.model,n,!1)}}return this.trigger("visibilityChange",this.visibleItems)},s.prototype.renderAllItems=function(){var t,n,r,i,s,o,u,a,f,l,c;i=this.collection.models,this.visibleItems=[],s={};for(u=0,f=i.length;u<f;u++)r=i[u],o=this.subview("itemView:"+r.cid),o&&(s[r.cid]=o);c=this.getItemViews();for(t in c){if(!e.call(c,t))continue;o=c[t],t in s||this.removeSubview("itemView:"+t)}for(n=a=0,l=i.length;a<l;n=++a)r=i[n],o=this.subview("itemView:"+r.cid),o?this.insertView(r,o,n,!1):this.renderAndInsertItem(r,n);if(!i.length)return this.trigger("visibilityChange",this.visibleItems)},s.prototype.renderAndInsertItem=function(e,t){var n;return n=this.renderItem(e),this.insertView(e,n,t)},s.prototype.renderItem=function(e){var t;return t=this.subview("itemView:"+e.cid),t||(t=this.getView(e),this.subview("itemView:"+e.cid,t)),t.render(),t},s.prototype.getView=function(e){if(this.itemView)return new this.itemView({model:e});throw new Error("The CollectionView#itemView property must be defined or the getView() must be overridden.")},s.prototype.insertView=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p=this;n==null&&(n=null),r==null&&(r=!0),c=typeof n=="number"?n:this.collection.indexOf(e),f=typeof this.filterer=="function"?this.filterer(e,c):!0,h=t.el,u=t.$el,f?r&&(this.useCssAnimation?u.addClass("animated-item-view"):u.css("opacity",0)):this.filterCallback(t,f),i=this.$list,a=this.itemSelector?i.children(this.itemSelector):i.children(),a.get(c)!==h&&(l=a.length,l===0||c===l?i.append(h):c===0?(s=a.eq(c),s.before(h)):(o=a.eq(c-1),o.after(h))),t.trigger("addedToDOM"),this.updateVisibleItems(e,f),r&&f&&(this.useCssAnimation?setTimeout(function(){return u.addClass("animated-item-view-end")},0):u.animate({opacity:1},this.animationDuration))},s.prototype.removeViewForItem=function(e){return this.updateVisibleItems(e,!1),this.removeSubview("itemView:"+e.cid)},s.prototype.updateVisibleItems=function(e,t,n){var r,s,o;return n==null&&(n=!0),s=!1,o=i(this.visibleItems).indexOf(e),r=o>-1,t&&!r?(this.visibleItems.push(e),s=!0):!t&&r&&(this.visibleItems.splice(o,1),s=!0),s&&n&&this.trigger("visibilityChange",this.visibleItems),s},s.prototype.dispose=function(){var e,t,n,r;if(this.disposed)return;t=["$list","$fallback","$loading","visibleItems"];for(n=0,r=t.length;n<r;n++)e=t[n],delete this[e];return s.__super__.dispose.apply(this,arguments)},s}(s)}),define("chaplin/lib/route",["underscore","backbone","chaplin/lib/event_broker","chaplin/controllers/controller"],function(t,n,i,s){"use strict";var o;return o=function(){function l(e,n,i){var o;this.options=i!=null?i:{},this.handler=r(this.handler,this),this.addParamName=r(this.addParamName,this),this.pattern=e,this.options.name!=null&&(this.name=this.options.name),o=n.split("#"),this.controller=o[0],this.action=o[1];if(t(s.prototype).has(this.action))throw new Error("Route: You should not use existing controller properties as action names");this.createRegExp()}var o,u,a,f;return l.extend=n.Model.extend,t(l.prototype).extend(i),f=["path","changeURL"],o=/[-[\]{}()+?.,\\^$|#\s]/g,u="&",a="=",l.prototype.reverse=function(e){var n,r,i;r=this.pattern;if(t.isRegExp(r))return!1;for(n in e)i=e[n],r=r.replace(RegExp(":"+n,"g"),i),r=r.replace(RegExp("\\*"+n,"g"),i);return this.test(r)?r:!1},l.prototype.createRegExp=function(){var e;if(t.isRegExp(this.pattern)){this.regExp=this.pattern,t.isArray(this.options.names)&&(this.paramNames=this.options.names);return}return e=this.pattern.replace(o,"\\$&").replace(/(?::|\*)(\w+)/g,this.addParamName),this.regExp=RegExp("^"+e+"(?=\\?|$)")},l.prototype.addParamName=function(e,n){var r;(r=this.paramNames)==null&&(this.paramNames=[]);if(t(f).include(n))throw new Error("Route#addParamName: parameter name "+n+" is reserved");return this.paramNames.push(n),e.charAt(0)===":"?"([^/?]+)":"(.*?)"},l.prototype.test=function(t){var n,r,i,s,o;i=this.regExp.test(t);if(!i)return!1;r=this.options.constraints;if(r){o=this.extractParams(t);for(s in r){if(!e.call(r,s))continue;n=r[s];if(!n.test(o[s]))return!1}}return!0},l.prototype.handler=function(e,t){var n;return t==null&&(t={}),n=this.buildParams(e),t.path=e,this.publishEvent("matchRoute",this,n,t)},l.prototype.buildParams=function(e){return t.extend({},this.extractQueryParams(e),this.extractParams(e),this.options.params)},l.prototype.extractParams=function(e){var t,n,r,i,s,o,u,a;s={},r=this.regExp.exec(e),a=r.slice(1);for(t=o=0,u=a.length;o<u;t=++o)n=a[t],i=this.paramNames?this.paramNames[t]:t,s[i]=n;return s},l.prototype.extractQueryParams=function(e){var t,n,r,i,s,o,f,l,c,h,p,d;o={},l=/\?(.+?)(?=#|$)/,r=l.exec(e);if(!r)return o;f=r[1],s=f.split(u);for(h=0,p=s.length;h<p;h++){i=s[h];if(!i.length)continue;d=i.split(a),n=d[0],c=d[1];if(!n.length)continue;n=decodeURIComponent(n),c=decodeURIComponent(c),t=o[n],t?t.push?t.push(c):o[n]=[t,c]:o[n]=c}return o},l}()}),define("chaplin/lib/router",["underscore","backbone","chaplin/mediator","chaplin/lib/event_broker","chaplin/lib/route"],function(e,t,n,i,s){"use strict";var o;return o=function(){function n(t){this.options=t!=null?t:{},this.route=r(this.route,this),this.match=r(this.match,this),e(this.options).defaults({pushState:!0}),this.subscribeEvent("!router:route",this.routeHandler),this.subscribeEvent("!router:reverse",this.reverseHandler),this.subscribeEvent("!router:changeURL",this.changeURLHandler),this.createHistory()}return n.extend=t.Model.extend,e(n.prototype).extend(i),n.prototype.createHistory=function(){return t.history||(t.history=new t.History)},n.prototype.startHistory=function(){return t.history.start(this.options)},n.prototype.stopHistory=function(){if(t.History.started)return t.history.stop()},n.prototype.match=function(e,n,r){var i;return r==null&&(r={}),i=new s(e,n,r),t.history.handlers.push({route:i,callback:i.handler}),i},n.prototype.route=function(n,r){var i,s,o,u;r==null&&(r={}),e(r).defaults({changeURL:!0}),n=n.replace(/^(\/#|\/)/,""),u=t.history.handlers;for(s=0,o=u.length;s<o;s++){i=u[s];if(i.route.test(n))return i.callback(n,r),!0}return!1},n.prototype.reverseHandler=function(e,t,n){return n(this.reverse(e,t))},n.prototype.reverse=function(e,n){var r,i,s,o,u;u=t.history.handlers;for(s=0,o=u.length;s<o;s++){r=u[s];if(r.route.name!==e)continue;i=r.route.reverse(n);if(i!==!1)return i}return!1},n.prototype.routeHandler=function(e,t,n){var r;return arguments.length===2&&typeof t=="function"&&(n=t,t={}),r=this.route(e,t),typeof n=="function"?n(r):void 0},n.prototype.changeURL=function(e,n){var r;return n==null&&(n={}),r={trigger:n.trigger===!0,replace:n.replace===!0},t.history.navigate(e,r)},n.prototype.changeURLHandler=function(e,t){return this.changeURL(e,t)},n.prototype.disposed=!1,n.prototype.dispose=function(){if(this.disposed)return;return this.stopHistory(),delete t.history,this.unsubscribeAllEvents(),this.disposed=!0,typeof Object.freeze=="function"?Object.freeze(this):void 0},n}()}),define("chaplin/lib/delayer",function(){"use strict";var e;return e={setTimeout:function(e,t,n){var r,i,s,o=this;return(s=this.timeouts)==null&&(this.timeouts={}),this.clearTimeout(e),i=function(){return delete o.timeouts[e],n()},r=setTimeout(i,t),this.timeouts[e]=r,r},clearTimeout:function(e){if(!this.timeouts||this.timeouts[e]==null)return;clearTimeout(this.timeouts[e]),delete this.timeouts[e]},clearAllTimeouts:function(){var e,t,n;if(!this.timeouts)return;n=this.timeouts;for(t in n)e=n[t],this.clearTimeout(t)},setInterval:function(e,t,n){var r,i;return this.clearInterval(e),(i=this.intervals)==null&&(this.intervals={}),r=setInterval(n,t),this.intervals[e]=r,r},clearInterval:function(e){if(!this.intervals||!this.intervals[e])return;clearInterval(this.intervals[e]),delete this.intervals[e]},clearAllIntervals:function(){var e,t,n;if(!this.intervals)return;n=this.intervals;for(t in n)e=n[t],this.clearInterval(t)},clearDelayed:function(){this.clearAllTimeouts(),this.clearAllIntervals()}},typeof Object.freeze=="function"&&Object.freeze(e),e}),define("chaplin/lib/event_broker",["chaplin/mediator"],function(e){"use strict";var t;return t={subscribeEvent:function(t,n){if(typeof t!="string")throw new TypeError("EventBroker#subscribeEvent: type argument must be a string");if(typeof n!="function")throw new TypeError("EventBroker#subscribeEvent: handler argument must be a function");return e.unsubscribe(t,n,this),e.subscribe(t,n,this)},unsubscribeEvent:function(t,n){if(typeof t!="string")throw new TypeError("EventBroker#unsubscribeEvent: type argument must be a string");if(typeof n!="function")throw new TypeError("EventBroker#unsubscribeEvent: handler argument must be a function");return e.unsubscribe(t,n)},unsubscribeAllEvents:function(){return e.unsubscribe(null,null,this)},publishEvent:function(){var t,n;n=arguments[0],t=2<=arguments.length?i.call(arguments,1):[];if(typeof n!="string")throw new TypeError("EventBroker#publishEvent: type argument must be a string");return e.publish.apply(e,[n].concat(i.call(t)))}},typeof Object.freeze=="function"&&Object.freeze(t),t}),define("chaplin/lib/support",function(){"use strict";var e;return e={propertyDescriptors:function(){var e;if(typeof Object.defineProperty!="function"||typeof Object.defineProperties!="function")return!1;try{return e={},Object.defineProperty(e,"foo",{value:"bar"}),e.foo==="bar"}catch(t){return!1}}()},e}),define("chaplin/lib/sync_machine",function(){"use strict";var e,t,n,r,i,s,o,u,a,f;i="unsynced",n="syncing",t="synced",e="syncStateChange",r={_syncState:i,_previousSyncState:null,syncState:function(){return this._syncState},isUnsynced:function(){return this._syncState===i},isSynced:function(){return this._syncState===t},isSyncing:function(){return this._syncState===n},unsync:function(){var r;if((r=this._syncState)===n||r===t)this._previousSync=this._syncState,this._syncState=i,this.trigger(this._syncState,this,this._syncState),this.trigger(e,this,this._syncState)},beginSync:function(){var r;if((r=this._syncState)===i||r===t)this._previousSync=this._syncState,this._syncState=n,this.trigger(this._syncState,this,this._syncState),this.trigger(e,this,this._syncState)},finishSync:function(){this._syncState===n&&(this._previousSync=this._syncState,this._syncState=t,this.trigger(this._syncState,this,this._syncState),this.trigger(e,this,this._syncState))},abortSync:function(){this._syncState===n&&(this._syncState=this._previousSync,this._previousSync=this._syncState,this.trigger(this._syncState,this,this._syncState),this.trigger(e,this,this._syncState))}},f=[i,n,t,e],o=function(e){return r[e]=function(t,n){n==null&&(n=this),this.on(e,t,n);if(this._syncState===e)return t.call(n)}};for(u=0,a=f.length;u<a;u++)s=f[u],o(s);return typeof Object.freeze=="function"&&Object.freeze(r),r}),define("chaplin/lib/utils",["chaplin/lib/support"],function(e){"use strict";var t;return t={beget:function(){var e;return typeof Object.create=="function"?Object.create:(e=function(){},function(t){return e.prototype=t,new e})}(),readonly:function(){var t;return e.propertyDescriptors?(t={writable:!1,enumerable:!0,configurable:!1},function(){var e,n,r,s,o;e=arguments[0],r=2<=arguments.length?i.call(arguments,1):[];for(s=0,o=r.length;s<o;s++)n=r[s],t.value=e[n],Object.defineProperty(e,n,t);return!0}):function(){return!1}}(),wrapMethod:function(e,n){var r;return r=e[n],e[""+n+"IsWrapped"]=!0,e[n]=function(){return e.disposed?!1:(r.apply(e,arguments),e["after"+t.upcase(n)].apply(e,arguments),e)}},upcase:function(e){return e.charAt(0).toUpperCase()+e.substring(1)},underscorize:function(e){return e.replace(/[A-Z]/g,function(e,t){return(t!==0?"_":"")+e.toLowerCase()})},modifierKeyPressed:function(e){return e.shiftKey||e.altKey||e.ctrlKey||e.metaKey}},typeof Object.seal=="function"&&Object.seal(t),t}),define("chaplin",["chaplin/application","chaplin/mediator","chaplin/dispatcher","chaplin/controllers/controller","chaplin/models/collection","chaplin/models/model","chaplin/views/layout","chaplin/views/view","chaplin/views/collection_view","chaplin/lib/route","chaplin/lib/router","chaplin/lib/delayer","chaplin/lib/event_broker","chaplin/lib/support","chaplin/lib/sync_machine","chaplin/lib/utils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){return{Application:e,mediator:t,Dispatcher:n,Controller:r,Collection:i,Model:s,Layout:o,View:u,CollectionView:a,Route:f,Router:l,Delayer:c,EventBroker:h,support:p,SyncMachine:d,utils:v}})}).call(this);